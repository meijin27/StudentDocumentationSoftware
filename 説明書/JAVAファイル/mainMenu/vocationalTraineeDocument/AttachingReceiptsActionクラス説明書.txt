AttachingReceiptsAction クラスに関する説明書

1. 概要
このクラスは、別紙　領収書添付用のPDFを作成し、ダウンロードします。
この書類にはユーザー入力項目はなく、すべて自動記入されます。

2. 主要な処理ステップ:
① セッションの確認: ユーザーのIDとマスターキーがセッションに存在するか確認します。
② データの復号化: マスターキーを使用してデータベースから取り出したデータを復号化します。
③ エラーチェック： データ不備をチェックします。
③ 自動入力：データベースに登録済みの情報（名前等）は自動で記入します。
④ 操作ログの追加: 別紙　領収書添付用の発行をデータベースの操作ログに追加します。

3. 詳細:
① セッションの確認: セッションのidとmaster_keyが存在しない場合、エラーメッセージをセットし、ログインページにリダイレクトします。
② データの復号化: データベースから取り出したデータは共通の暗号キーを使用して復号化します。その後、Decryptクラスを使用してセッションからマスターキー、IV、ユーザーIDを取得します。取得したマスターキーとIVを使用して、データを再度復号化します。
③ エラーチェック： 職業訓練生のデータがデータベースに登録されていない場合、元のページに戻ります。
④ 氏名・クラス名をデータベースから取り出し、自動でPDFに記入します。
⑤ 操作ログの追加: 別紙　領収書添付用の発行をデータベースの操作ログに追加します。

4. 例外処理:
もしデータベースへのアクセスや暗号化処理中に例外が発生した場合、エラーメッセージをログに記録し、エラーメッセージをリクエストにセットして、元のページに戻ります。

5. 終了処理:
すべての処理が正常に終了した場合、PDFがダウンロードされます。画面遷移は行われません。