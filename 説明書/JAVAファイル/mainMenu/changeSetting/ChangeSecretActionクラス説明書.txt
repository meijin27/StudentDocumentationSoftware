ChangeSecretAction クラスに関する説明書

1. 概要
このクラスは、ユーザーの秘密の質問および答えを変更するアクションを定義しています。入力されたパスワード、秘密の質問、答えに関するバリデーション後、ユーザーデータベースを更新します。

2. 主要な処理ステップ:
① セッションの確認
② 入力値の取得
③ パスワードのバリデーション
④ データベースのパスワード一致確認
⑤ 秘密の質問・答えの更新
⑥ 操作ログの追加

3. 詳細:
① セッションの確認: セッションからIDとmaster_keyが存在しない場合、エラーメッセージをセットし、ログインページにリダイレクトします。
② 入力値の取得: リクエストから現在のパスワード (password), 秘密の質問 (secretQuestion), その答え (secretAnswer) を取得します。
③ バリデーション:
	・パスワード、秘密の質問、答えが未入力の場合、エラーメッセージをセットします。
	・入力されたパスワードや答えが32文字を超える場合、エラーメッセージをセットします。
④ データベースのパスワード一致確認: ユーザーIDを元にデータベースから登録されているパスワードを取得し、入力されたパスワードと比較します。
⑤ 秘密の質問・答えの更新: 暗号化・ハッシュ化を使用して新しい秘密の質問、答え、マスターキーを更新します。
⑥ 操作ログの追加: ユーザーIDを元にデータベースの操作ログに「Change SecretQuestion & Answer」という操作を追加します。

4. 例外処理:
データベースへのアクセスや暗号化処理中に例外が発生した場合、エラーメッセージをログに記録し、エラーメッセージをリクエストにセットして、元のページに戻ります。

5. 終了処理:
すべての処理が正常に終了した場合、成功メッセージをセットして、成功画面に遷移します。